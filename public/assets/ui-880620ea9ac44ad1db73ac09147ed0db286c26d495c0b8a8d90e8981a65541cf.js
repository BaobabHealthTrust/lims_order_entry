function __$(e){return document.getElementById(e)}function init(){if(document.forms.length>0){loadLabels();for(var e=document.forms[0].elements,t=0,n=0;n<e.length;n++)"hidden"!=e[n].type.toLowerCase()&&(navFields.push(e[n]),globalEditControls[e[n].id]=t,globalControlsOrder.push(e[n].id),t++)}}function loadLabels(){for(var e=document.getElementsByTagName("LABEL"),t=0;t<e.length;t++)if(""!=e[t].htmlFor){var n=document.getElementById(e[t].htmlFor);n&&(n.label=e[t])}}function showShield(e){if(void 0==e&&(e=!1),__$("shield"))document.body.removeChild(__$("shield")),null!=spinner&&hideSpinner(),null!=smallSpinner&&hideSmallSpinner();else{var t=document.createElement("div");t.id="shield",t.style.position="absolute",t.style.width="100%",t.style.height="100%",t.style.top="0px",t.style.left="0px",t.style.backgroundColor="rgba(200,200,200,0.5)",t.style.zIndex=110,document.body.appendChild(t),e&&(t.onmousedown=function(){"undefined"!=typeof selectedTest&&(selectedTest=null),"undefined"!=typeof selectedTestSpecimen&&(selectedTestSpecimen=null),__$("popup")&&document.body.removeChild(__$("popup")),__$("shield")&&document.body.removeChild(__$("shield"))})}}function showSpinner(){if(!document.getElementById("spin")){var e=document.createElement("div");e.id="spin",e.style.position="absolute",e.style.top=window.innerHeight/2-80+"px",e.style.left=window.innerWidth/2-25+"px",document.body.appendChild(e);var t={lines:15,length:15,width:8,radius:20,corners:1,rotate:0,color:"#000",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:25,left:25}}var n=document.getElementById("spin");spinner=new Spinner(t).spin(n),showShield()}function hideSpinner(){spinner.stop(),__$("shield")&&document.body.removeChild(__$("shield"))}function showSmallSpinner(){if(!document.getElementById("spin")){var e=document.createElement("div");e.id="spin",e.style.position="absolute",e.style.top=window.innerHeight/2-25+"px",e.style.left=window.innerWidth/2-25+"px",document.body.appendChild(e);var t={lines:15,length:15,width:8,radius:20,corners:1,rotate:0,color:"#000",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:25,left:25}}var n=document.getElementById("spin");smallSpinner=new Spinner(t).spin(n)}function hideSmallSpinner(){smallSpinner.stop()}function __$(e){return document.getElementById(e)}function checkCtrl(e){for(var t=e,n=t.offsetTop,r=t.offsetLeft+1,i=t.offsetWidth,s=t.offsetHeight;t?t.offsetParent!=document.body:!1;)t=t.offsetParent,n+=t?t.offsetTop:0,r+=t?t.offsetLeft:0;return[i,s,n,r]}function showKeyboard(e,t,n,r,i){if(__$(t)){var s=__$(t);if(__$("popupkeyboard")&&void 0==r)s.removeChild(__$("popupkeyboard"));else{if(void 0==e||void 0==s)return;__$("popupkeyboard"),s.innerHTML="";{var o=e;checkCtrl(e)}"undefined"==typeof n&&(n={}),"undefined"==typeof r&&(r=!1),"undefined"==typeof i&&(i=!1),currentCaseUpper=i,currentKeysNumeric=r;var l=document.createElement("div");l.id="popupkeyboard",l.style.margin="auto",l.style.borderRadius="10px",l.style.backgroundColor="rgba(255,255,255,1.0)",s.appendChild(l);var a,u="Done";void 0!=globalEditControls[globalControl.id]&&parseInt(globalEditControls[globalControl.id])<globalControlsOrder.length-1&&(u="Next"),a=currentKeysNumeric?currentKeysQWERTY?[[1,2,3],[4,5,6],[7,8,9],["qwe",":","/",0,".","&larr;",u]]:[[1,2,3],[4,5,6],[7,8,9],["abc",":","/",0,".","&larr;",u]]:currentKeysQWERTY?[["Q","W","E","R","T","Y","U","I","O","P"],["A","S","D","F","G","H","J","K","L","CAP"],["num","Z","X","C","V","B","N","M","abc","&larr;"],[":",".","&nbsp;","/",u]]:[["A","B","C","D","E","F","G","H","I","J"],["K","L","M","N","O","P","Q","R","S","CAP"],["num","T","U","V","W","X","Y","Z","qwe","&larr;"],[":",".","&nbsp;","/",u]];var c={A:!0,B:!0,C:!0,D:!0,E:!0,F:!0,G:!0,H:!0,I:!0,J:!0,K:!0,L:!0,M:!0,N:!0,O:!0,P:!0,Q:!0,R:!0,S:!0,T:!0,U:!0,V:!0,W:!0,X:!0,Y:!0,Z:!0,CAP:!0},f=document.createElement("div");f.style.display="table",f.style.margin="auto",l.appendChild(f);for(var d=0;d<a.length;d++){var p=document.createElement("div");p.style.display="table-row",f.appendChild(p);var y=document.createElement("div");y.style.display="table-cell",y.style.textAlign="center",y.style.padding="0px",p.appendChild(y);for(var m=0;m<a[d].length;m++)if(0!=String(a[d][m]).trim().length){var h=document.createElement("button");h.setAttribute("class",n[a[d][m]]?"button_gray":"button_blue"),h.style.width="40px",h.style.height="60px",h.style.minWidth="30px",h.style.minHeight="40px",h.style.margin="2px",h.style.fontSize="24px",h.style.borderRadius="8px",h.setAttribute("parent",s.id),y.appendChild(h),"num"!=a[d][m]&&"qwe"!=a[d][m]&&"abc"!=a[d][m]&&"Done"!=a[d][m]&&"Next"!=a[d][m]&&FastClick.attach(h),h.id=a[d][m],o&&"."==a[d][m]&&(o.value.trim().match(/\./)||0==o.value.trim().length?h.setAttribute("class","button_gray"):h.setAttribute("class","button_blue")),"hide"==a[d][m]?(h.style.fontSize="12px",h.style.padding="0px"):a[d][m]==u||"num"==a[d][m]||"qwe"==a[d][m]||"abc"==a[d][m]||"cap"==a[d][m]||"CAP"==a[d][m]||"&larr;"==String(a[d][m]).trim()?("num"==a[d][m]||"cap"==a[d][m].toLowerCase().trim()?h.style.paddingLeft="5px":"abc"==a[d][m]||"qwe"==a[d][m].toLowerCase().trim()||"&larr;"==String(a[d][m]).trim()?h.style.paddingLeft="7px":a[d][m]==u&&(h.style.paddingLeft="3px"),h.style.textAlign="center",h.style.width="40px"):"&nbsp;"==String(a[d][m]).trim()&&(h.style.width="260px"),h.innerHTML="cap"==String(a[d][m]).trim().toLowerCase()?"<span style='font-size: 14px;'>"+("cap"==String(a[d][m]).trim().toLowerCase()?currentCaseUpper?String(a[d][m]).toUpperCase():String(a[d][m]).toLowerCase():currentCaseUpper?String(a[d][m]).toLowerCase():String(a[d][m]).toUpperCase()):c[a[d][m]]?"cap"==String(a[d][m]).trim().toLowerCase()?currentCaseUpper?String(a[d][m]).toUpperCase():String(a[d][m]).toLowerCase():currentCaseUpper?String(a[d][m]).toLowerCase():String(a[d][m]).toUpperCase():a[d][m]==u||"num"==a[d][m]||"qwe"==a[d][m]||"abc"==a[d][m]||"cap"==a[d][m]||"CAP"==a[d][m]?"<span style='font-size: 14px;'>"+a[d][m]:a[d][m],n[a[d][m]]?h.setAttribute("class","button_gray"):(h.setAttribute("class","button_blue"),h.addEventListener("touchend",function(){Date.now()},!1),h.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),cTime=Date.now();var t="";if(t=this.innerHTML.trim().match(/<span.+>/i)?this.children[0].innerHTML:this.innerHTML,8592==t.trim().charCodeAt(0))o&&(o.value=o.value.trim().substring(0,o.value.trim().length-1));else if("num"==t.trim())currentKeysNumeric=!0,showKeyboard(__$(o.id),this.getAttribute("parent"),n,currentKeysNumeric,currentCaseUpper);else if("abc"==t.trim())currentKeysQWERTY=!1,currentKeysNumeric=!1,showKeyboard(__$(o.id),this.getAttribute("parent"),n,currentKeysNumeric,currentCaseUpper);else if("qwe"==t.trim())currentKeysQWERTY=!0,currentKeysNumeric=!1,showKeyboard(__$(o.id),this.getAttribute("parent"),n,currentKeysNumeric,currentCaseUpper);else if("?"==t.trim())o.value="?";else if("cap"==t.trim().toLowerCase()){currentCaseUpper=!currentCaseUpper;var r=Object.keys(c);if(currentCaseUpper){for(var i=0;i<r.length-1;i++)__$(r[i])&&(__$(r[i]).innerHTML=r[i].toLowerCase());this.innerHTML="<span style='font-size: 14px;'>CAP</span>"}else{for(var i=0;i<r.length-1;i++)__$(r[i])&&(__$(r[i]).innerHTML=r[i].toUpperCase());this.innerHTML="<span style='font-size: 14px;'>cap</span>"}}else if("&nbsp;"==t.trim())o.value+=" ";else{if(t.trim()==u){if(globalControl.value=o.value.trim()+(attachUnits&&o.value.trim().length>0?" "+currentUnits:""),void 0!=globalEditControls[globalControl.id]&&parseInt(globalEditControls[globalControl.id])<globalControlsOrder.length-1){var s=globalControlsOrder[parseInt(globalEditControls[globalControl.id])+1];if("undefined"!=typeof __$(s))return __$("target")&&document.body.removeChild(__$("target")),void setTimeout(function(){captureFreetext(__$(s))},25);__$("target")&&document.body.removeChild(__$("target"))}else __$("target")&&document.body.removeChild(__$("target"));return}"?"==o.value.trim()||"Unknown"==o.value.trim()?o.value=currentCaseUpper?t.trim().toLowerCase():t.trim():overwriteNumber?(o.value=currentCaseUpper?t.trim().toLowerCase():t.trim(),overwriteNumber=!1,o.value.trim().length>0&&__$("CAP")&&!currentCaseUpper&&__$("CAP").click()):(o.value+=currentCaseUpper?t.trim().toLowerCase():t.trim(),o.value.trim().length>0&&__$("CAP")&&!currentCaseUpper&&__$("CAP").click())}n["."]||__$(".").setAttribute("class","button_blue")},!1)),"Unknown"==String(a[d][m]).trim()&&(h.style.fontSize="14px",cell.style.marginTop="-10px")}}}}}function confirmAction(msg,action){"undefined"!=typeof Android?Android.confirmAction(msg,action):confirm(msg)&&eval(action)}function showMsg(e){"undefined"!=typeof Android?Android.showMsg(e):alert(e)}function captureFreetext(e,t,n,r){void 0==t&&(t=!1),attachUnits=t,globalControl=e,currentUnits=globalControl.getAttribute("units"),null==currentUnits&&(currentUnits="");var i=attachUnits?e.value.trim().replace(currentUnits,"").trim():e.value.trim(),s=document.createElement("div");s.id="target",s.style.position="absolute",s.style.left="0px",s.style.top="0px",s.style.height="100%",s.style.width="100%",s.style.backgroundColor="rgba(0,0,0,0.8)",s.style.padding="10px",document.body.appendChild(s),FastClick.attach(__$("target")),__$("target").onclick=function(){__$("target")&&(__$("textArea")&&(globalControl.value=__$("textArea").value.trim()+(attachUnits&&__$("textArea").value.trim().length>0?" "+currentUnits:"")),document.body.removeChild(__$("target")))};var o=document.createElement("table");o.id="myTable",o.style.margin="auto",s.appendChild(o);var l=document.createElement("tbody");o.appendChild(l);var a=document.createElement("tr");l.appendChild(a);var u=document.createElement("tr");l.appendChild(u);var c=document.createElement("td");a.appendChild(c);var f=document.createElement("td");u.appendChild(f);var d=document.createElement("div");d.style.height="150px",d.style.width="100%",c.appendChild(d);var p=document.createElement("div");p.id="keysDiv",p.style.width="100%",f.appendChild(p);var y=document.createElement("textarea");y.id="textArea",y.style.width="95%",y.style.height="80%",y.style.padding="10px",y.style.fontSize="24px",y.style.setProperty("-webkit-user-select","none"),y.style.setProperty("-moz-user-select","none"),y.value=i,"password"==e.type&&y.style.setProperty("-webkit-text-security","circle"),y.onkeydown=function(e){"undefined"==typeof Android&&13==e.keyCode&&__$(navKey)&&__$(navKey).click()},d.appendChild(y),"undefined"==typeof r&&(r=!1),showKeyboard(y,"keysDiv",void 0,n,r),y.focus()}function showMsgForAction(e,t){showShield(!0),__$("shield")||showShield(!0),__$("popup")&&document.body.removeChild(__$("popup"));var n=document.createElement("div");n.id="popup",n.style.position="absolute",n.style.minHeight="200px",n.style.backgroundColor="#fff",n.style.zIndex=120,n.style.border="2px outset #eee",n.style.borderRadius="8px",document.body.appendChild(n);var r=document.createElement("table");r.width="100%",r.style.fontSize="24px",n.appendChild(r);var i=document.createElement("tbody");r.appendChild(i);var s=document.createElement("tr");i.appendChild(s);var o=document.createElement("th");o.innerHTML=void 0==t?"Info":t,o.style.backgroundColor="#345d8c",o.style.color="#fff",o.style.borderTopLeftRadius="8px",o.style.borderTopRightRadius="8px",o.style.border="2px outset #23538a",o.colSpan="2",o.style.padding="5px",s.appendChild(o);var l=document.createElement("tr");i.appendChild(l);var a=document.createElement("td");a.colSpan="2",a.style.padding="5px",a.style.paddingTop="5px",a.style.paddingBottom="5px",a.align="center",a.style.lineHeight="120%",a.style.fontSize="20px",l.appendChild(a),a.innerHTML=e;var u=document.createElement("tr");i.appendChild(u);var c=document.createElement("td");c.align="center",c.style.padding="5px",c.setAttribute("colspan",2),u.appendChild(c);var f=document.createElement("button");if(f.className="button_blue",f.innerHTML="OK",f.style.width="120px",f.style.cursor="pointer",f.style.fontSize="24px",f.style.minHeight="60px",c.appendChild(f),f.onmousedown=function(){__$("popup")&&document.body.removeChild(__$("popup")),__$("shield")&&document.body.removeChild(__$("shield"))},__$("popup")){var d=checkCtrl(__$("popup"));__$("popup").style.top=window.innerHeight/2-d[1]/2+"px",__$("popup").style.left=window.innerWidth/2-d[0]/2+"px"}}function formatTimestamp(timestamp){var time=timestamp.match(/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/);if(null!=time){var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],month=months[eval(time[2])-1],date=eval(time[3]),result=date+"/"+month+"/"+time[1]+" "+time[4]+":"+time[5]+":"+time[6];return result}return timestamp}var globalEditControls={},globalControlsOrder=[],attachUnits=!1,currentUnits="",navFields=[],spinner,smallSpinner;navigator.sayswho=function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"IE "+(e[1]||"")):"Chrome"===n[1]&&(e=t.match(/\b(OPR|Edge)\/(\d+)/),null!=e)?e.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))}();var currentCaseUpper=!1,currentKeysNumeric=!1,currentKeysQWERTY=!0,overwriteNumber=!1,globalControl,cTime;setTimeout(function(){init()},500);